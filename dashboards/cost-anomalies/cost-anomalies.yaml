dashboards:
  AWS COST ANOMALIES DASHBOARD:
    category: 'Advanced'
    dependsOn:
      datasets:
      - ca_summary_view
    name: AWS Cost Anomalies
    dashboardId: aws-cost-anomalies
    data: |-
      AnalysisDefaults:
        DefaultNewSheetConfiguration:
          InteractiveLayoutConfiguration:
            Grid:
              CanvasSizeOptions:
                ScreenCanvasSizeOptions:
                  OptimizedViewPortWidth: 1600px
                  ResizeOption: FIXED
          SheetContentType: INTERACTIVE
      CalculatedFields:
      - DataSetIdentifier: ca_summary_view
        Expression: linkedaccountname
        Name: Account
      - DataSetIdentifier: ca_summary_view
        Expression: ifelse({payer_id} ='0', 'All','All')
        Name: All
      - DataSetIdentifier: ca_summary_view
        Expression: concat(Account,':',service,':',usagetype,':',region)
        Name: Details
      - DataSetIdentifier: ca_summary_view
        Expression: |-
          ifelse(${GroupBy}='Account ID',linkedaccount,
          ${GroupBy}='Account Name',linkedaccountname,
          ${GroupBy}= 'Payer Account ID', {payer_id},
          ${GroupBy}= 'All', All,
          All)
        Name: Group by
      - DataSetIdentifier: ca_summary_view
        Expression: '{Max Last Update} = anomalylastupdatedate'
        Name: Last Update Date is Max Last Update Date
      - DataSetIdentifier: ca_summary_view
        Expression: maxOver(anomalylastupdatedate, [anomalyid], PRE_AGG)
        Name: Max Last Update
      - DataSetIdentifier: ca_summary_view
        Expression: totalactualspend
        Name: Total Actual Spend
      - DataSetIdentifier: ca_summary_view
        Expression: totalexpectedspend
        Name: Total Expected Spend
      - DataSetIdentifier: ca_summary_view
        Expression: '{total_impact}'
        Name: Total Impact
      - DataSetIdentifier: ca_summary_view
        Expression: totalimpactpercentage * 100
        Name: percentage
      - DataSetIdentifier: ca_summary_view
        Expression: |-
          ifelse (
            dateDiff(anomalylastupdatedate,now(),'DD') >= ${numberofdays},"Past","Active"
          )
        Name: status
      ColumnConfigurations:
      - Column:
          ColumnName: Total Actual Spend
          DataSetIdentifier: ca_summary_view
        FormatConfiguration:
          NumberFormatConfiguration:
            FormatConfiguration:
              CurrencyDisplayFormatConfiguration:
                DecimalPlacesConfiguration:
                  DecimalPlaces: 2
                NegativeValueConfiguration:
                  DisplayMode: POSITIVE
                NullValueFormatConfiguration:
                  NullString: 'null'
                NumberScale: AUTO
                SeparatorConfiguration:
                  DecimalSeparator: DOT
                  ThousandsSeparator:
                    Symbol: COMMA
                    Visibility: VISIBLE
                Symbol: USD
      - Column:
          ColumnName: Total Expected Spend
          DataSetIdentifier: ca_summary_view
        FormatConfiguration:
          NumberFormatConfiguration:
            FormatConfiguration:
              CurrencyDisplayFormatConfiguration:
                DecimalPlacesConfiguration:
                  DecimalPlaces: 2
                NegativeValueConfiguration:
                  DisplayMode: POSITIVE
                NullValueFormatConfiguration:
                  NullString: 'null'
                NumberScale: AUTO
                SeparatorConfiguration:
                  DecimalSeparator: DOT
                  ThousandsSeparator:
                    Symbol: COMMA
                    Visibility: VISIBLE
                Symbol: USD
      - Column:
          ColumnName: Total Impact
          DataSetIdentifier: ca_summary_view
        FormatConfiguration:
          NumberFormatConfiguration:
            FormatConfiguration:
              CurrencyDisplayFormatConfiguration:
                DecimalPlacesConfiguration:
                  DecimalPlaces: 2
                NegativeValueConfiguration:
                  DisplayMode: POSITIVE
                NullValueFormatConfiguration:
                  NullString: 'null'
                NumberScale: AUTO
                SeparatorConfiguration:
                  DecimalSeparator: DOT
                  ThousandsSeparator:
                    Symbol: COMMA
                    Visibility: VISIBLE
                Symbol: USD
      - Column:
          ColumnName: anomaly_start_date
          DataSetIdentifier: ca_summary_view
        FormatConfiguration:
          DateTimeFormatConfiguration:
            DateTimeFormat: MMM D YYYY, h A
            NullValueFormatConfiguration:
              NullString: 'null'
      - Column:
          ColumnName: maximpact
          DataSetIdentifier: ca_summary_view
        FormatConfiguration:
          NumberFormatConfiguration:
            FormatConfiguration:
              CurrencyDisplayFormatConfiguration:
                DecimalPlacesConfiguration:
                  DecimalPlaces: 2
                NegativeValueConfiguration:
                  DisplayMode: POSITIVE
                NullValueFormatConfiguration:
                  NullString: 'null'
                SeparatorConfiguration:
                  DecimalSeparator: DOT
                  ThousandsSeparator:
                    Symbol: COMMA
                    Visibility: VISIBLE
                Symbol: USD
      - ColorsConfiguration:
          CustomColors:
          - Color: '#DE3B00'
            FieldValue: Open
        Column:
          ColumnName: status
          DataSetIdentifier: ca_summary_view
      - Column:
          ColumnName: totalactualspend
          DataSetIdentifier: ca_summary_view
        FormatConfiguration:
          NumberFormatConfiguration:
            FormatConfiguration:
              CurrencyDisplayFormatConfiguration:
                DecimalPlacesConfiguration:
                  DecimalPlaces: 2
                NegativeValueConfiguration:
                  DisplayMode: POSITIVE
                NullValueFormatConfiguration:
                  NullString: 'null'
                SeparatorConfiguration:
                  DecimalSeparator: DOT
                  ThousandsSeparator:
                    Symbol: COMMA
                    Visibility: VISIBLE
                Symbol: USD
      DataSetIdentifierDeclarations:
      - DataSetArn: arn:aws:quicksight:::dataset/56b6e410-125e-4277-8fbc-9f12f62c65cd
        Identifier: ca_summary_view
      FilterGroups:
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: 8f2c0181-52c9-4b73-9426-d7d89a82b450
        Filters:
        - RelativeDatesFilter:
            AnchorDateConfiguration:
              AnchorOption: NOW
            Column:
              ColumnName: anomaly_start_date
              DataSetIdentifier: ca_summary_view
            FilterId: 92ca5e80-1cdc-4fd2-8b47-f692053d46b7
            MinimumGranularity: DAY
            NullOption: NON_NULLS_ONLY
            RelativeDateType: LAST
            RelativeDateValue: 4
            TimeGranularity: MONTH
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: SELECTED_VISUALS
              SheetId: f611928c-4543-4ff9-b878-a8ca1e65aacd
              VisualIds:
              - a7a0902c-d301-4346-b5b2-4e83dacce002
        Status: DISABLED
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: 1ff15e80-a055-4588-b878-c7a78c02d30d
        Filters:
        - NumericEqualityFilter:
            Column:
              ColumnName: Last Update Date is Max Last Update Date
              DataSetIdentifier: ca_summary_view
            FilterId: 35911ca4-beb7-412b-b629-d0fd34e0d9c2
            MatchOperator: EQUALS
            NullOption: ALL_VALUES
            Value: 1.0
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: SELECTED_VISUALS
              SheetId: f611928c-4543-4ff9-b878-a8ca1e65aacd
              VisualIds:
              - c13f2a82-5518-4704-8bf3-bc0cb3733ba4
              - a7a0902c-d301-4346-b5b2-4e83dacce002
              - aa5167a3-2547-48b0-ab75-52211be4ddd4
              - 4d37575c-4771-4ccf-8c71-51587ab09657
              - 36546801-c538-4ca8-8ed2-f6825e68d23f
        Status: DISABLED
      - CrossDataset: SINGLE_DATASET
        FilterGroupId: 7f9a67a4-8184-47db-853a-c8499d232dbd
        Filters:
        - RelativeDatesFilter:
            AnchorDateConfiguration:
              AnchorOption: NOW
            Column:
              ColumnName: anomaly_start_date
              DataSetIdentifier: ca_summary_view
            FilterId: 806e916e-ef65-4b1f-9a55-722a0f2368a8
            MinimumGranularity: DAY
            NullOption: NON_NULLS_ONLY
            RelativeDateType: LAST
            RelativeDateValue: 4
            TimeGranularity: MONTH
        ScopeConfiguration:
          SelectedSheets:
            SheetVisualScopingConfigurations:
            - Scope: SELECTED_VISUALS
              SheetId: f611928c-4543-4ff9-b878-a8ca1e65aacd
              VisualIds:
              - 6da5675f-b9c1-4844-b3da-742f65a6bd39
        Status: DISABLED
      ParameterDeclarations:
      - DecimalParameterDeclaration:
          DefaultValues:
            StaticValues:
            - 0.0
          Name: TotalImpactThreshold
          ParameterValueType: SINGLE_VALUED
          ValueWhenUnset:
            ValueWhenUnsetOption: RECOMMENDED_VALUE
      - IntegerParameterDeclaration:
          DefaultValues:
            StaticValues:
            - 7
          Name: numberofdays
          ParameterValueType: SINGLE_VALUED
          ValueWhenUnset:
            ValueWhenUnsetOption: RECOMMENDED_VALUE
      - StringParameterDeclaration:
          DefaultValues: {}
          Name: linkedaccount
          ParameterValueType: MULTI_VALUED
          ValueWhenUnset:
            ValueWhenUnsetOption: RECOMMENDED_VALUE
      - StringParameterDeclaration:
          DefaultValues:
            StaticValues: []
          Name: AccountName
          ParameterValueType: SINGLE_VALUED
          ValueWhenUnset:
            ValueWhenUnsetOption: RECOMMENDED_VALUE
      - StringParameterDeclaration:
          DefaultValues:
            StaticValues: []
          Name: payeraccount
          ParameterValueType: SINGLE_VALUED
          ValueWhenUnset:
            ValueWhenUnsetOption: RECOMMENDED_VALUE
      - StringParameterDeclaration:
          DefaultValues:
            StaticValues:
            - Active
            - Past
          Name: status
          ParameterValueType: MULTI_VALUED
          ValueWhenUnset:
            ValueWhenUnsetOption: RECOMMENDED_VALUE
      - StringParameterDeclaration:
          DefaultValues:
            StaticValues:
            - All
          Name: GroupBy
          ParameterValueType: SINGLE_VALUED
          ValueWhenUnset:
            ValueWhenUnsetOption: 'NULL'
      - DateTimeParameterDeclaration:
          DefaultValues:
            RollingDate:
              Expression: addDateTime(-1, 'MM', truncDate('MM', now()))
            StaticValues: []
          Name: AnomalyStartDateRange
          TimeGranularity: DAY
      - DateTimeParameterDeclaration:
          DefaultValues:
            RollingDate:
              Expression: addDateTime(-90, 'DD', truncDate('DD', now()))
            StaticValues: []
          Name: startdate
          TimeGranularity: DAY
      - DateTimeParameterDeclaration:
          DefaultValues:
            RollingDate:
              Expression: truncDate('DD', now())
            StaticValues: []
          Name: enddate
          TimeGranularity: DAY
      Sheets:
      - ContentType: INTERACTIVE
        Layouts:
        - Configuration:
            GridLayout:
              CanvasSizeOptions:
                ScreenCanvasSizeOptions:
                  OptimizedViewPortWidth: 1600px
                  ResizeOption: FIXED
              Elements:
              - ColumnIndex: 0
                ColumnSpan: 14
                ElementId: 06d8fd74-63c8-4f1e-8729-7b507588fe60
                ElementType: TEXT_BOX
                RowIndex: 0
                RowSpan: 4
              - ColumnIndex: 14
                ColumnSpan: 17
                ElementId: 12639c44-36a9-4a31-9aff-39825fe1e91f
                ElementType: TEXT_BOX
                RowIndex: 0
                RowSpan: 4
              - ColumnIndex: 31
                ColumnSpan: 5
                ElementId: 0242b4bf-9667-4886-afc8-156564e737d9
                ElementType: PARAMETER_CONTROL
                RowIndex: 0
                RowSpan: 4
              - ColumnIndex: 0
                ColumnSpan: 31
                ElementId: aa5167a3-2547-48b0-ab75-52211be4ddd4
                ElementType: VISUAL
                RowIndex: 4
                RowSpan: 10
              - ColumnIndex: 31
                ColumnSpan: 5
                ElementId: 4d37575c-4771-4ccf-8c71-51587ab09657
                ElementType: VISUAL
                RowIndex: 4
                RowSpan: 10
              - ColumnIndex: 0
                ColumnSpan: 18
                ElementId: 36546801-c538-4ca8-8ed2-f6825e68d23f
                ElementType: VISUAL
                RowIndex: 14
                RowSpan: 10
              - ColumnIndex: 18
                ColumnSpan: 18
                ElementId: c13f2a82-5518-4704-8bf3-bc0cb3733ba4
                ElementType: VISUAL
                RowIndex: 14
                RowSpan: 10
              - ColumnIndex: 0
                ColumnSpan: 36
                ElementId: a7a0902c-d301-4346-b5b2-4e83dacce002
                ElementType: VISUAL
                RowIndex: 24
                RowSpan: 14
              - ColumnIndex: 0
                ColumnSpan: 36
                ElementId: 6da5675f-b9c1-4844-b3da-742f65a6bd39
                ElementType: VISUAL
                RowIndex: 38
                RowSpan: 14
        Name: AWS Cost Anomalies
        ParameterControls:
        - DateTimePicker:
            DisplayOptions:
              DateTimeFormat: YYYY/MM/DD HH:mm:ss
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: 7efa69f9-81df-4230-ae46-f5c47d97851e
            SourceParameterName: enddate
            Title: End Date
        - DateTimePicker:
            DisplayOptions:
              DateTimeFormat: YYYY/MM/DD HH:mm:ss
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: 2f70293a-fd1b-43c3-bd35-73679e64d7d6
            SourceParameterName: startdate
            Title: Start Date
        - Slider:
            DisplayOptions:
              InfoIconLabelOptions:
                Visibility: HIDDEN
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            MaximumValue: 100000.0
            MinimumValue: 0.0
            ParameterControlId: 0242b4bf-9667-4886-afc8-156564e737d9
            SourceParameterName: TotalImpactThreshold
            StepSize: 200.0
            Title: Total Impact Greater then
        - TextField:
            DisplayOptions:
              InfoIconLabelOptions:
                Visibility: HIDDEN
              PlaceholderOptions:
                Visibility: VISIBLE
              TitleOptions:
                FontConfiguration:
                  FontSize:
                    Relative: MEDIUM
                Visibility: VISIBLE
            ParameterControlId: daed692c-42a2-4974-816e-2ea370479e97
            SourceParameterName: numberofdays
            Title: Days to consider Active
        SheetControlLayouts:
        - Configuration:
            GridLayout:
              Elements:
              - ColumnIndex: 10
                ColumnSpan: 2
                ElementId: daed692c-42a2-4974-816e-2ea370479e97
                ElementType: PARAMETER_CONTROL
                RowIndex: 0
                RowSpan: 1
              - ColumnIndex: 0
                ColumnSpan: 2
                ElementId: 2f70293a-fd1b-43c3-bd35-73679e64d7d6
                ElementType: PARAMETER_CONTROL
                RowIndex: 1
                RowSpan: 1
              - ColumnIndex: 2
                ColumnSpan: 2
                ElementId: 7efa69f9-81df-4230-ae46-f5c47d97851e
                ElementType: PARAMETER_CONTROL
                RowIndex: 1
                RowSpan: 1
        SheetId: f611928c-4543-4ff9-b878-a8ca1e65aacd
        TextBoxes:
        - Content: "<text-box>\n  <inline font-size=\"40px\">AWS Cost Anomalies Dashboard\_\
            </inline>\n  <br/>\n  <inline font-size=\"20px\">Historical view on Cost Anomalies\
            \ across Oraganizations</inline>\n</text-box>"
          SheetTextBoxId: 06d8fd74-63c8-4f1e-8729-7b507588fe60
        - Content: "<text-box>\n  <inline font-size=\"16px\">\n    <b>&#128161; Insights:</b>\n\
            \  </inline>\n  <br/>\n  <ul>\n    <li>\n      At least 1 cost anomaly monitor\
            \ should be configured to view the results of cost anomaly detection [\n   \
            \   <a href=\"https://catalog.workshops.aws/awscff/en-US/foundations/3-cost-anomaly\"\
            \ target=\"_blank\">1</a>\n      ].\n    </li>\n    <li>\n      This dashbaord\
            \ is build for reviews and long term analysis for reactive notification use\
            \ built-in mechanism in AWS Cost Anomaly service [\n      <a href=\"https://docs.aws.amazon.com/cost-management/latest/userguide/ad-SNS.html\"\
            \ target=\"_blank\">2</a>\n      ].\n    </li>\n    <li>\n      <inline color=\"\
            #161e2d\" font-size=\"14px\">In the event that there is no clear root cause\
            \ for the anomaly,\_\_</inline>\n      <inline font-size=\"14px\">Account Id,\
            \ Account Name, Usage Type and Region recorded as\_</inline>\n      null\n \
            \     <inline font-size=\"14px\">\_in the visuals [</inline>\n      <inline\
            \ font-size=\"14px\">\n        <a href=\"https://aws.amazon.com/aws-cost-management/aws-cost-anomaly-detection/faqs/\"\
            \ target=\"_blank\">3</a>\n      </inline>\n      <inline font-size=\"14px\"\
            >].</inline>\n    </li>\n  </ul>\n</text-box>"
          SheetTextBoxId: 12639c44-36a9-4a31-9aff-39825fe1e91f
        Visuals:
        - BarChartVisual:
            Actions:
            - ActionOperations:
              - FilterOperation:
                  SelectedFieldsConfiguration:
                    SelectedFields:
                    - 0e0f5f65-03fe-4bbd-b40d-34a68730292e.anomalyid.2.1729867991947
                  TargetVisualsConfiguration:
                    SameSheetTargetVisualConfiguration:
                      TargetVisualOptions: ALL_VISUALS
              CustomActionId: 5196277a-ddbe-4ac8-b168-bc39e9b85f42
              Name: Action 1
              Status: ENABLED
              Trigger: DATA_POINT_CLICK
            ChartConfiguration:
              BarsArrangement: STACKED
              CategoryAxis:
                DataOptions:
                  DateAxisOptions:
                    MissingDateVisibility: VISIBLE
              DataLabels:
                Overlap: DISABLE_OVERLAP
                Visibility: VISIBLE
              FieldWells:
                BarChartAggregatedFieldWells:
                  Category:
                  - DateDimensionField:
                      Column:
                        ColumnName: anomalylastupdatedate
                        DataSetIdentifier: ca_summary_view
                      FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.anomalylastupdatedate.2.1729867752015
                      HierarchyId: 5426d337-7da9-4aa6-9afe-fc2a29f087a7
                  Colors:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: anomalyid
                        DataSetIdentifier: ca_summary_view
                      FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.anomalyid.2.1729867991947
                  Values:
                  - NumericalMeasureField:
                      AggregationFunction:
                        SimpleNumericalAggregation: SUM
                      Column:
                        ColumnName: Total Impact
                        DataSetIdentifier: ca_summary_view
                      FieldId: 4b6586bc-8389-44e1-93d6-61636c3bf371.2.1733981878191
              Legend:
                Visibility: HIDDEN
                Width: 287px
              Orientation: VERTICAL
              SortConfiguration:
                CategoryItemsLimit:
                  OtherCategories: EXCLUDE
                CategorySort:
                - FieldSort:
                    Direction: ASC
                    FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.anomalylastupdatedate.2.1729867752015
                ColorItemsLimit:
                  OtherCategories: EXCLUDE
                SmallMultiplesLimitConfiguration:
                  OtherCategories: EXCLUDE
              Tooltip:
                FieldBasedTooltip:
                  AggregationVisibility: HIDDEN
                  TooltipFields:
                  - FieldTooltipItem:
                      FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.anomalylastupdatedate.2.1729867752015
                      Visibility: VISIBLE
                  - FieldTooltipItem:
                      FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.anomalyid.2.1729867991947
                      Visibility: VISIBLE
                  - ColumnTooltipItem:
                      Aggregation:
                        AttributeAggregationFunction:
                          SimpleAttributeAggregation: UNIQUE_VALUE
                      Column:
                        ColumnName: service
                        DataSetIdentifier: ca_summary_view
                      Visibility: VISIBLE
                  - ColumnTooltipItem:
                      Aggregation:
                        AttributeAggregationFunction:
                          SimpleAttributeAggregation: UNIQUE_VALUE
                      Column:
                        ColumnName: Account
                        DataSetIdentifier: ca_summary_view
                      Visibility: VISIBLE
                  - ColumnTooltipItem:
                      Aggregation:
                        AttributeAggregationFunction:
                          SimpleAttributeAggregation: UNIQUE_VALUE
                      Column:
                        ColumnName: usagetype
                        DataSetIdentifier: ca_summary_view
                      Visibility: VISIBLE
                  - ColumnTooltipItem:
                      Aggregation:
                        NumericalAggregationFunction:
                          SimpleNumericalAggregation: SUM
                      Column:
                        ColumnName: Total Actual Spend
                        DataSetIdentifier: ca_summary_view
                      Visibility: VISIBLE
                  - ColumnTooltipItem:
                      Aggregation:
                        NumericalAggregationFunction:
                          SimpleNumericalAggregation: SUM
                      Column:
                        ColumnName: Total Expected Spend
                        DataSetIdentifier: ca_summary_view
                      Visibility: VISIBLE
                  - FieldTooltipItem:
                      FieldId: 4b6586bc-8389-44e1-93d6-61636c3bf371.2.1733981878191
                      Visibility: VISIBLE
                  TooltipTitleType: PRIMARY_VALUE
                SelectedTooltipType: DETAILED
                TooltipVisibility: VISIBLE
            ColumnHierarchies:
            - DateTimeHierarchy:
                DrillDownFilters: []
                HierarchyId: 5426d337-7da9-4aa6-9afe-fc2a29f087a7
            Subtitle:
              FormatText:
                RichText: <visual-subtitle>Select anomaly in the table above to focus. More
                  details available in the tooltips</visual-subtitle>
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: <visual-title>Daily Cost Anomalies Total Impact</visual-title>
              Visibility: VISIBLE
            VisualId: 6da5675f-b9c1-4844-b3da-742f65a6bd39
        - BarChartVisual:
            Actions:
            - ActionOperations:
              - FilterOperation:
                  SelectedFieldsConfiguration:
                    SelectedFieldOptions: ALL_FIELDS
                  TargetVisualsConfiguration:
                    SameSheetTargetVisualConfiguration:
                      TargetVisualOptions: ALL_VISUALS
              CustomActionId: 3d608954-5fef-487c-9028-83b22d26a677
              Name: Action 1
              Status: ENABLED
              Trigger: DATA_POINT_CLICK
            ChartConfiguration:
              BarsArrangement: CLUSTERED
              CategoryAxis:
                AxisLineVisibility: VISIBLE
                ScrollbarOptions:
                  Visibility: VISIBLE
              CategoryLabelOptions:
                SortIconVisibility: HIDDEN
                Visibility: HIDDEN
              DataLabels:
                Overlap: DISABLE_OVERLAP
                Visibility: VISIBLE
              FieldWells:
                BarChartAggregatedFieldWells:
                  Category:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: service
                        DataSetIdentifier: ca_summary_view
                      FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.service.2.1725975644777
                  Colors: []
                  Values:
                  - NumericalMeasureField:
                      AggregationFunction:
                        SimpleNumericalAggregation: SUM
                      Column:
                        ColumnName: Total Actual Spend
                        DataSetIdentifier: ca_summary_view
                      FieldId: ce4579ec-ce78-43eb-a49e-64499862b098.4.1729866290439
                  - NumericalMeasureField:
                      AggregationFunction:
                        SimpleNumericalAggregation: SUM
                      Column:
                        ColumnName: Total Expected Spend
                        DataSetIdentifier: ca_summary_view
                      FieldId: dd810294-c26c-499b-acbc-d8f38c797666.4.1729866311684
                  - NumericalMeasureField:
                      AggregationFunction:
                        SimpleNumericalAggregation: SUM
                      Column:
                        ColumnName: Total Impact
                        DataSetIdentifier: ca_summary_view
                      FieldId: 4f55cd1e-ee07-4cba-a75f-f2b1905f0ac3.3.1729866338320
              Legend:
                Height: 64px
                Position: AUTO
                Title:
                  Visibility: HIDDEN
                Visibility: VISIBLE
                Width: 157px
              Orientation: HORIZONTAL
              SortConfiguration:
                CategoryItemsLimit:
                  OtherCategories: INCLUDE
                CategorySort:
                - FieldSort:
                    Direction: DESC
                    FieldId: ce4579ec-ce78-43eb-a49e-64499862b098.4.1729866290439
                ColorItemsLimit:
                  OtherCategories: INCLUDE
                SmallMultiplesLimitConfiguration:
                  OtherCategories: INCLUDE
              Tooltip:
                FieldBasedTooltip:
                  AggregationVisibility: HIDDEN
                  TooltipFields:
                  - FieldTooltipItem:
                      FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.service.2.1725975644777
                      Visibility: VISIBLE
                  - FieldTooltipItem:
                      FieldId: ce4579ec-ce78-43eb-a49e-64499862b098.4.1729866290439
                      Visibility: VISIBLE
                  - FieldTooltipItem:
                      FieldId: dd810294-c26c-499b-acbc-d8f38c797666.4.1729866311684
                      Visibility: VISIBLE
                  - FieldTooltipItem:
                      FieldId: 4f55cd1e-ee07-4cba-a75f-f2b1905f0ac3.3.1729866338320
                      Visibility: VISIBLE
                  TooltipTitleType: PRIMARY_VALUE
                SelectedTooltipType: BASIC
                TooltipVisibility: VISIBLE
              ValueAxis:
                GridLineVisibility: HIDDEN
                TickLabelOptions:
                  LabelOptions:
                    Visibility: VISIBLE
            ColumnHierarchies: []
            Subtitle:
              FormatText:
                RichText: <visual-subtitle>Total Impact</visual-subtitle>
              Visibility: HIDDEN
            Title:
              FormatText:
                RichText: "<visual-title>Total Impact Cost\_</visual-title>"
              Visibility: VISIBLE
            VisualId: 36546801-c538-4ca8-8ed2-f6825e68d23f
        - BarChartVisual:
            Actions:
            - ActionOperations:
              - FilterOperation:
                  SelectedFieldsConfiguration:
                    SelectedFields:
                    - 8a3f3ec1-d96f-4fcb-a556-7391401524e2.2.1725973064206
                  TargetVisualsConfiguration:
                    SameSheetTargetVisualConfiguration:
                      TargetVisualOptions: ALL_VISUALS
              CustomActionId: 0603c74c-c90d-465a-affd-276a3fedc19d
              Name: Action 1
              Status: ENABLED
              Trigger: DATA_POINT_CLICK
            ChartConfiguration:
              BarsArrangement: STACKED
              DataLabels:
                Overlap: DISABLE_OVERLAP
                TotalsVisibility: VISIBLE
                Visibility: VISIBLE
              FieldWells:
                BarChartAggregatedFieldWells:
                  Category:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: Account
                        DataSetIdentifier: ca_summary_view
                      FieldId: 8a3f3ec1-d96f-4fcb-a556-7391401524e2.2.1725973064206
                  Colors:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: service
                        DataSetIdentifier: ca_summary_view
                      FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.service.2.1725968468201
                  Values:
                  - NumericalMeasureField:
                      AggregationFunction:
                        SimpleNumericalAggregation: SUM
                      Column:
                        ColumnName: Total Impact
                        DataSetIdentifier: ca_summary_view
                      FieldId: b4866425-7eff-4852-865b-e3935902a23e.2.1725967100020
              Legend:
                Height: 64px
                Position: AUTO
                Title:
                  Visibility: HIDDEN
                Visibility: VISIBLE
                Width: 223px
              Orientation: HORIZONTAL
              SortConfiguration:
                CategoryItemsLimit:
                  OtherCategories: INCLUDE
                CategorySort:
                - FieldSort:
                    Direction: DESC
                    FieldId: b4866425-7eff-4852-865b-e3935902a23e.2.1725967100020
                ColorItemsLimit:
                  OtherCategories: INCLUDE
                ColorSort:
                - FieldSort:
                    Direction: DESC
                    FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.service.2.1725968468201
                SmallMultiplesLimitConfiguration:
                  OtherCategories: INCLUDE
              Tooltip:
                FieldBasedTooltip:
                  AggregationVisibility: HIDDEN
                  TooltipFields:
                  - FieldTooltipItem:
                      FieldId: b4866425-7eff-4852-865b-e3935902a23e.2.1725967100020
                      Visibility: VISIBLE
                  - FieldTooltipItem:
                      FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.service.2.1725968468201
                      Visibility: VISIBLE
                  - FieldTooltipItem:
                      FieldId: 8a3f3ec1-d96f-4fcb-a556-7391401524e2.2.1725973064206
                      Visibility: VISIBLE
                  TooltipTitleType: PRIMARY_VALUE
                SelectedTooltipType: BASIC
                TooltipVisibility: VISIBLE
              ValueAxis:
                GridLineVisibility: HIDDEN
                TickLabelOptions:
                  LabelOptions:
                    Visibility: VISIBLE
            ColumnHierarchies: []
            Subtitle:
              FormatText:
                RichText: <visual-subtitle>Total Impact</visual-subtitle>
              Visibility: HIDDEN
            Title:
              FormatText:
                RichText: <visual-title>AWS Cost Anomalies - Service (Total Cost Impact)</visual-title>
              Visibility: VISIBLE
            VisualId: c13f2a82-5518-4704-8bf3-bc0cb3733ba4
        - TableVisual:
            Actions:
            - ActionOperations:
              - FilterOperation:
                  SelectedFieldsConfiguration:
                    SelectedFields:
                    - 0e0f5f65-03fe-4bbd-b40d-34a68730292e.anomalyid.12.1729867637032
                  TargetVisualsConfiguration:
                    SameSheetTargetVisualConfiguration:
                      TargetVisualOptions: ALL_VISUALS
              CustomActionId: daaf0e00-bd5c-4e8a-aac1-80a518e24afa
              Name: Action 1
              Status: ENABLED
              Trigger: DATA_POINT_CLICK
            ChartConfiguration:
              FieldOptions:
                Order: []
                SelectedFieldOptions:
                - FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.anomalyid.12.1729867637032
                  Visibility: HIDDEN
                  Width: 254px
                - CustomLabel: Service
                  FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.service.2.1686744080024
                  Width: 296px
                - CustomLabel: Account ID
                  FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.linkedaccount.5.1686759391866
                  Width: 111px
                - CustomLabel: Account Name
                  FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.linkedaccountname.7.1686760943959
                  Width: 140px
                - CustomLabel: Region
                  FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.region.10.1688542840413
                - CustomLabel: Usage Type
                  FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.usagetype.8.1686760952029
                  Width: 162px
                - CustomLabel: Start Date
                  FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.anomaly_start_date.0.1686744069603
                  Width: 141px
                - CustomLabel: Last Update
                  FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.anomalylastupdatedate.11.1725972061234
                - CustomLabel: Status
                  FieldId: 29d6de89-a42f-47b9-a077-d9c421e79def.9.1688530165960
                  Width: 66px
                - CustomLabel: Total Actual Spend
                  FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.totalactualspend.1.1686744072810
                  Width: 113px
                - CustomLabel: Total Expected Spend
                  FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.totalexpectedspend.6.1686759551680
                  Width: 115px
                - CustomLabel: Total Impact
                  FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.total_impact.12.1733983004090
                  Width: 91px
                - CustomLabel: Duration days
                  FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.duration.11.1729862998580
                  Width: 74px
              FieldWells:
                TableAggregatedFieldWells:
                  GroupBy:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: anomalyid
                        DataSetIdentifier: ca_summary_view
                      FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.anomalyid.12.1729867637032
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: service
                        DataSetIdentifier: ca_summary_view
                      FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.service.2.1686744080024
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: linkedaccount
                        DataSetIdentifier: ca_summary_view
                      FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.linkedaccount.5.1686759391866
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: linkedaccountname
                        DataSetIdentifier: ca_summary_view
                      FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.linkedaccountname.7.1686760943959
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: region
                        DataSetIdentifier: ca_summary_view
                      FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.region.10.1688542840413
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: usagetype
                        DataSetIdentifier: ca_summary_view
                      FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.usagetype.8.1686760952029
                  - DateDimensionField:
                      Column:
                        ColumnName: anomaly_start_date
                        DataSetIdentifier: ca_summary_view
                      DateGranularity: MINUTE
                      FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.anomaly_start_date.0.1686744069603
                  - DateDimensionField:
                      Column:
                        ColumnName: anomalylastupdatedate
                        DataSetIdentifier: ca_summary_view
                      FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.anomalylastupdatedate.11.1725972061234
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: status
                        DataSetIdentifier: ca_summary_view
                      FieldId: 29d6de89-a42f-47b9-a077-d9c421e79def.9.1688530165960
                  Values:
                  - NumericalMeasureField:
                      AggregationFunction:
                        SimpleNumericalAggregation: SUM
                      Column:
                        ColumnName: totalactualspend
                        DataSetIdentifier: ca_summary_view
                      FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.totalactualspend.1.1686744072810
                      FormatConfiguration:
                        FormatConfiguration:
                          CurrencyDisplayFormatConfiguration:
                            DecimalPlacesConfiguration:
                              DecimalPlaces: 2
                            NegativeValueConfiguration:
                              DisplayMode: POSITIVE
                            SeparatorConfiguration:
                              DecimalSeparator: DOT
                              ThousandsSeparator:
                                Symbol: COMMA
                                Visibility: VISIBLE
                            Symbol: USD
                  - NumericalMeasureField:
                      AggregationFunction:
                        SimpleNumericalAggregation: SUM
                      Column:
                        ColumnName: totalexpectedspend
                        DataSetIdentifier: ca_summary_view
                      FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.totalexpectedspend.6.1686759551680
                      FormatConfiguration:
                        FormatConfiguration:
                          CurrencyDisplayFormatConfiguration:
                            DecimalPlacesConfiguration:
                              DecimalPlaces: 2
                            NegativeValueConfiguration:
                              DisplayMode: POSITIVE
                            SeparatorConfiguration:
                              DecimalSeparator: DOT
                              ThousandsSeparator:
                                Symbol: COMMA
                                Visibility: VISIBLE
                            Symbol: USD
                  - NumericalMeasureField:
                      AggregationFunction:
                        SimpleNumericalAggregation: SUM
                      Column:
                        ColumnName: total_impact
                        DataSetIdentifier: ca_summary_view
                      FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.total_impact.12.1733983004090
                      FormatConfiguration:
                        FormatConfiguration:
                          CurrencyDisplayFormatConfiguration:
                            DecimalPlacesConfiguration:
                              DecimalPlaces: 2
                            NegativeValueConfiguration:
                              DisplayMode: POSITIVE
                            NullValueFormatConfiguration:
                              NullString: 'null'
                            SeparatorConfiguration:
                              DecimalSeparator: DOT
                              ThousandsSeparator:
                                Symbol: COMMA
                                Visibility: VISIBLE
                            Symbol: USD
                  - NumericalMeasureField:
                      AggregationFunction:
                        SimpleNumericalAggregation: SUM
                      Column:
                        ColumnName: duration
                        DataSetIdentifier: ca_summary_view
                      FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.duration.11.1729862998580
              SortConfiguration: {}
              TableInlineVisualizations:
              - DataBars:
                  FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.total_impact.12.1733983004090
                  NegativeColor: '#DE3B00'
                  PositiveColor: '#F6AA54'
              TableOptions:
                CellStyle:
                  Height: 25
                  HorizontalTextAlignment: CENTER
                  TextWrap: WRAP
                HeaderStyle:
                  Height: 50
                  HorizontalTextAlignment: CENTER
                  TextWrap: WRAP
                  Visibility: VISIBLE
                RowAlternateColorOptions:
                  Status: ENABLED
              TotalOptions:
                Placement: END
                ScrollStatus: PINNED
                TotalsVisibility: VISIBLE
            ConditionalFormatting:
              ConditionalFormattingOptions:
              - Cell:
                  FieldId: 29d6de89-a42f-47b9-a077-d9c421e79def.9.1688530165960
                  TextFormat:
                    TextColor:
                      Solid:
                        Color: '#DE3B00'
                        Expression: '{status} = "Active"'
              - Cell:
                  FieldId: 29d6de89-a42f-47b9-a077-d9c421e79def.9.1688530165960
                  TextFormat:
                    Icon:
                      CustomCondition:
                        Color: '#DE3B00'
                        Expression: '{status} = "Open"'
                        IconOptions:
                          Icon: FLAG
              - Cell:
                  FieldId: 29d6de89-a42f-47b9-a077-d9c421e79def.9.1688530165960
                  TextFormat:
                    Icon:
                      CustomCondition:
                        Color: '#AAAAAA'
                        Expression: '{status} = "Closed"'
                        IconOptions:
                          Icon: CHECKMARK
            Subtitle:
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: <visual-title>AWS Cost Anomalies Details</visual-title>
              Visibility: VISIBLE
            VisualId: a7a0902c-d301-4346-b5b2-4e83dacce002
        - BarChartVisual:
            Actions:
            - ActionOperations:
              - FilterOperation:
                  SelectedFieldsConfiguration:
                    SelectedFields:
                    - 0e0f5f65-03fe-4bbd-b40d-34a68730292e.service.2.1725975644777
                  TargetVisualsConfiguration:
                    SameSheetTargetVisualConfiguration:
                      TargetVisualOptions: ALL_VISUALS
              CustomActionId: 5a7a32db-caef-49fb-9bcf-4b234585e354
              Name: Action 1
              Status: ENABLED
              Trigger: DATA_POINT_CLICK
            ChartConfiguration:
              BarsArrangement: STACKED
              CategoryAxis:
                AxisLineVisibility: VISIBLE
                ScrollbarOptions:
                  Visibility: HIDDEN
              CategoryLabelOptions:
                SortIconVisibility: HIDDEN
                Visibility: HIDDEN
              DataLabels:
                Overlap: DISABLE_OVERLAP
                TotalsVisibility: VISIBLE
                Visibility: VISIBLE
              FieldWells:
                BarChartAggregatedFieldWells:
                  Category:
                  - DateDimensionField:
                      Column:
                        ColumnName: anomaly_start_date
                        DataSetIdentifier: ca_summary_view
                      DateGranularity: MONTH
                      FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.anomaly_start_date.1.1686733460628
                      HierarchyId: 59cd7cc9-0749-46b0-aacb-4ff1428f8fe2
                  Colors:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: service
                        DataSetIdentifier: ca_summary_view
                      FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.service.2.1725975644777
                  Values:
                  - NumericalMeasureField:
                      AggregationFunction:
                        SimpleNumericalAggregation: SUM
                      Column:
                        ColumnName: Total Impact
                        DataSetIdentifier: ca_summary_view
                      FieldId: 4f55cd1e-ee07-4cba-a75f-f2b1905f0ac3.2.1729866375404
              Legend:
                Height: 64px
                Position: AUTO
                Title:
                  Visibility: HIDDEN
                Visibility: VISIBLE
                Width: 274px
              Orientation: VERTICAL
              SortConfiguration:
                CategoryItemsLimit:
                  OtherCategories: INCLUDE
                CategorySort:
                - FieldSort:
                    Direction: ASC
                    FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.anomaly_start_date.1.1686733460628
                ColorItemsLimit:
                  OtherCategories: INCLUDE
                SmallMultiplesLimitConfiguration:
                  OtherCategories: INCLUDE
              Tooltip:
                FieldBasedTooltip:
                  AggregationVisibility: HIDDEN
                  TooltipFields:
                  - FieldTooltipItem:
                      FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.anomaly_start_date.1.1686733460628
                      Visibility: VISIBLE
                  - FieldTooltipItem:
                      FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.service.2.1725975644777
                      Visibility: VISIBLE
                  - FieldTooltipItem:
                      FieldId: 4f55cd1e-ee07-4cba-a75f-f2b1905f0ac3.2.1729866375404
                      Visibility: VISIBLE
                  TooltipTitleType: PRIMARY_VALUE
                SelectedTooltipType: BASIC
                TooltipVisibility: VISIBLE
              ValueAxis:
                GridLineVisibility: HIDDEN
                TickLabelOptions:
                  LabelOptions:
                    Visibility: VISIBLE
            ColumnHierarchies:
            - DateTimeHierarchy:
                DrillDownFilters: []
                HierarchyId: 59cd7cc9-0749-46b0-aacb-4ff1428f8fe2
            Subtitle:
              FormatText:
                RichText: <visual-subtitle>Total Impact</visual-subtitle>
              Visibility: HIDDEN
            Title:
              FormatText:
                RichText: "<visual-title>Total Impact Cost\_by Anomaly Start Date</visual-title>"
              Visibility: VISIBLE
            VisualId: aa5167a3-2547-48b0-ab75-52211be4ddd4
        - PieChartVisual:
            Actions:
            - ActionOperations:
              - FilterOperation:
                  SelectedFieldsConfiguration:
                    SelectedFieldOptions: ALL_FIELDS
                  TargetVisualsConfiguration:
                    SameSheetTargetVisualConfiguration:
                      TargetVisualOptions: ALL_VISUALS
              CustomActionId: a59b94f7-e096-42fc-a37e-f1f2ac4691fd
              Name: Action 1
              Status: ENABLED
              Trigger: DATA_POINT_CLICK
            ChartConfiguration:
              CategoryLabelOptions:
                AxisLabelOptions:
                - ApplyTo:
                    Column:
                      ColumnName: status
                      DataSetIdentifier: ca_summary_view
                    FieldId: 29d6de89-a42f-47b9-a077-d9c421e79def.0.1688537174069
                  CustomLabel: <<$GroupBy>>
              DataLabels:
                CategoryLabelVisibility: VISIBLE
                LabelContent: VALUE
                LabelFontConfiguration:
                  FontSize:
                    Relative: EXTRA_LARGE
                MeasureLabelVisibility: VISIBLE
                Overlap: DISABLE_OVERLAP
                Position: OUTSIDE
                Visibility: VISIBLE
              DonutOptions:
                ArcOptions:
                  ArcThickness: MEDIUM
              FieldWells:
                PieChartAggregatedFieldWells:
                  Category:
                  - CategoricalDimensionField:
                      Column:
                        ColumnName: status
                        DataSetIdentifier: ca_summary_view
                      FieldId: 29d6de89-a42f-47b9-a077-d9c421e79def.0.1688537174069
                  Values:
                  - CategoricalMeasureField:
                      AggregationFunction: COUNT
                      Column:
                        ColumnName: anomalyid
                        DataSetIdentifier: ca_summary_view
                      FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.anomalyid.1.1729865549365
              Legend:
                Width: 70px
              SortConfiguration:
                CategoryItemsLimit:
                  OtherCategories: INCLUDE
                CategorySort:
                - FieldSort:
                    Direction: DESC
                    FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.anomalyid.1.1729865549365
                SmallMultiplesLimitConfiguration:
                  OtherCategories: INCLUDE
              Tooltip:
                FieldBasedTooltip:
                  AggregationVisibility: HIDDEN
                  TooltipFields:
                  - FieldTooltipItem:
                      FieldId: 29d6de89-a42f-47b9-a077-d9c421e79def.0.1688537174069
                      Visibility: VISIBLE
                  - FieldTooltipItem:
                      FieldId: 0e0f5f65-03fe-4bbd-b40d-34a68730292e.anomalyid.1.1729865549365
                      Visibility: VISIBLE
                  - ColumnTooltipItem:
                      Aggregation:
                        NumericalAggregationFunction:
                          SimpleNumericalAggregation: SUM
                      Column:
                        ColumnName: Total Impact
                        DataSetIdentifier: ca_summary_view
                      Visibility: VISIBLE
                  TooltipTitleType: PRIMARY_VALUE
                SelectedTooltipType: DETAILED
                TooltipVisibility: VISIBLE
              VisualPalette:
                ColorMap:
                - Color: '#AAAAAA'
                  Element:
                    FieldId: 29d6de89-a42f-47b9-a077-d9c421e79def.0.1688537174069
                    FieldValue: Closed
                - Color: '#AAAAAA'
                  Element:
                    FieldId: 29d6de89-a42f-47b9-a077-d9c421e79def.0.1688537174069
                    FieldValue: Past
                - Color: '#DE3B00'
                  Element:
                    FieldId: 29d6de89-a42f-47b9-a077-d9c421e79def.0.1688537174069
                    FieldValue: Active
            ColumnHierarchies: []
            Subtitle:
              FormatText:
                RichText: |-
                  <visual-subtitle>
                    Status changes to Past after '
                    <parameter>${numberofdays}</parameter>
                    ' days.
                    <br/>
                    You can change in Controls.
                  </visual-subtitle>
              Visibility: VISIBLE
            Title:
              FormatText:
                RichText: <visual-title>Anomalies Status</visual-title>
              Visibility: VISIBLE
            VisualId: 4d37575c-4771-4ccf-8c71-51587ab09657
      - ContentType: INTERACTIVE
        Layouts:
        - Configuration:
            GridLayout:
              CanvasSizeOptions:
                ScreenCanvasSizeOptions:
                  OptimizedViewPortWidth: 1600px
                  ResizeOption: FIXED
              Elements:
              - ColumnIndex: 0
                ColumnSpan: 36
                ElementId: 384699fa-14d8-4399-af5d-4e4fa2b09d98
                ElementType: TEXT_BOX
                RowIndex: 0
                RowSpan: 6
              - ColumnIndex: 0
                ColumnSpan: 36
                ElementId: d9a12df7-0c6e-4942-9403-b82db7d5f754
                ElementType: TEXT_BOX
                RowIndex: 6
                RowSpan: 14
        Name: About
        SheetControlLayouts:
        - Configuration:
            GridLayout:
              Elements: []
        SheetId: a311d7ca-9d15-4b3e-b884-bb82bde4585d
        TextBoxes:
        - Content: "<text-box>\n  <br/>\n  <block align=\"center\"/>\n  <br/>\n  <block\
            \ align=\"center\"/>\n  <br/>\n  <block align=\"center\">\n    <inline font-size=\"\
            40px\">AWS Cost Anomaly Insights Dashboard</inline>\n  </block>\n  <br/>\n \
            \ <block align=\"center\">\n    <inline font-size=\"32px\">v2.0.0</inline>\n\
            \  </block>\n  <br/>\n  <block align=\"center\"/>\n  <br/>\n  <block align=\"\
            center\"/>\n  <br/>\n  <block align=\"center\">\n    <inline font-size=\"24px\"\
            >\n      <a href=\"https://docs.aws.amazon.com/guidance/latest/cloud-intelligence-dashboards/cost-anomaly-dashboard.html\"\
            \ target=\"_blank\">Documentation</a>\n    </inline>\n    <inline font-size=\"\
            24px\">\_|\_</inline>\n    <inline font-size=\"24px\">\n      <a href=\"https://github.com/aws-samples/aws-cudos-framework-deployment/blob/main/changes/CHANGELOG-cost-anomalies.md\"\
            \ target=\"_blank\">Changelog</a>\n    </inline>\n    <inline font-size=\"24px\"\
            >\_|\_</inline>\n    <inline font-size=\"24px\">\n      <a href=\"https://docs.aws.amazon.com/guidance/latest/cloud-intelligence-dashboards/cost-anomaly-dashboard.html#prerequisites\"\
            \ target=\"_blank\">Deployment</a>\n    </inline>\n    <inline font-size=\"\
            24px\">\_|\_</inline>\n    <inline font-size=\"24px\">\n      <a href=\"https://catalog.workshops.aws/awscid/en-US/feedback-support\"\
            \ target=\"_blank\">Feedback</a>\n    </inline>\n    <inline font-size=\"24px\"\
            >\_</inline>\n  </block>\n  <br/>\n  <block align=\"center\"/>\n  <br/>\n  <block\
            \ align=\"right\"/>\n  <br/>\n  <block align=\"right\"/>\n  <br/>\n  <block\
            \ align=\"right\"/>\n  <br/>\n  <block align=\"right\"/>\n  <br/>\n  <block\
            \ align=\"right\"/>\n  <br/>\n  <block align=\"right\">Built by: Yash Bindlish,\
            \  Yuriy Prykhodko,  Iakov Gan</block>\n  <br/>\n  <block align=\"right\">Powered\
            \ by: Amazon QuickSight, Amazon Athena, Amazon S3</block>\n  <br/>\n  <block\
            \ align=\"right\">If you wish to provide feedback or report an error please\
            \ email: cloud-intelligence-dashboards@amazon.com</block>\n</text-box>"
          SheetTextBoxId: d9a12df7-0c6e-4942-9403-b82db7d5f754
        - Content: "<text-box>\n  <inline font-size=\"20px\">\n    <b>Notices</b>\n  </inline>\n\
            \  <br/>\n  <br/>\n  <inline font-size=\"14px\">Customers are responsible for\
            \ making their own independent assessment of\_this dashboard and its content.\_\
            This dashboard and its content: (a) is for informational purposes only, (b)\
            \ represents current AWS product offerings and practices, which are subject\
            \ to change without notice, and (c) does not create any commitments or assurances\
            \ from AWS and its affiliates, suppliers or licensors. AWS\_content, products\
            \ or services are provided \u201Cas is\u201D without warranties, representations,\
            \ or conditions of any kind, whether express or implied. The responsibilities\
            \ and liabilities of AWS to its customers are controlled by AWS agreements,\
            \ and this document is not part of, nor does it modify, any agreement between\
            \ AWS and its customers.</inline>\n</text-box>"
          SheetTextBoxId: 384699fa-14d8-4399-af5d-4e4fa2b09d98
        Visuals: []
datasets:
  ca_summary_view:
    data:
      DataSetId: ca_summary_view
      Name: ca_summary_view
      PhysicalTableMap:
        9d57c16a-be68-49b0-ba70-def54caddfa0:
          RelationalTable:
            DataSourceArn: ${athena_datasource_arn}
            Catalog: AwsDataCatalog
            Schema: ${athena_database_name}
            Name: cost_anomalies
            InputColumns:
            - Name: year
              Type: STRING
            - Name: month
              Type: STRING
            - Name: payer_id
              Type: STRING
            - Name: anomalyid
              Type: STRING
            - Name: dimensionvalue
              Type: STRING
            - Name: anomaly_start_date
              Type: DATETIME
            - Name: anomalylastupdatedate
              Type: DATETIME
            - Name: maximpact
              Type: DECIMAL
              SubType: FLOAT
            - Name: totalactualspend
              Type: DECIMAL
              SubType: FLOAT
            - Name: totalexpectedspend
              Type: DECIMAL
              SubType: FLOAT
            - Name: total_impact
              Type: DECIMAL
              SubType: FLOAT
            - Name: totalimpactpercentage
              Type: DECIMAL
              SubType: FLOAT
            - Name: duration
              Type: INTEGER
            - Name: monitorarn
              Type: STRING
            - Name: region
              Type: STRING
            - Name: service
              Type: STRING
            - Name: linkedaccountname
              Type: STRING
            - Name: linkedaccount
              Type: STRING
            - Name: usagetype
              Type: STRING
            - Name: contribution
              Type: STRING
      LogicalTableMap:
        9e9295e1-da62-46cb-be40-15bb46afa171:
          Alias: cost_anomalies
          DataTransforms:
          - TagColumnOperation:
              ColumnName: region
              Tags:
              - ColumnGeographicRole: STATE
          - ProjectOperation:
              ProjectedColumns:
              - year
              - month
              - payer_id
              - anomalyid
              - dimensionvalue
              - anomaly_start_date
              - anomalylastupdatedate
              - maximpact
              - totalactualspend
              - totalexpectedspend
              - total_impact
              - totalimpactpercentage
              - duration
              - monitorarn
              - region
              - service
              - linkedaccountname
              - linkedaccount
              - usagetype
              - contribution
          Source:
            PhysicalTableId: 9d57c16a-be68-49b0-ba70-def54caddfa0
      ImportMode: SPICE
    dependsOn:
      views:
      - cost_anomalies
    schedules:
    - default
crawlers: {}
views:
  cost_anomalies:
    data: |-
      CREATE OR REPLACE VIEW "cost_anomalies" AS
      WITH unnested_data AS (
        SELECT
          "year"
        , "month"
        , payer_id
        , anomalyid
        , dimensionvalue
        , CAST("from_iso8601_timestamp"("anomalystartdate") AS date) anomaly_start_date
        , CAST("from_iso8601_timestamp"("anomalyenddate") AS date) anomalylastupdatedate
        , CAST(maximpact AS double) maximpact
        , CAST(totalactualspend AS double) totalactualspend
        , CAST(totalexpectedspend AS double) totalexpectedspend
        , CAST(totalimpact AS double) total_impact
        , CAST(totalimpactpercentage AS double) totalimpactpercentage
        , EXTRACT(DAY FROM (CAST("from_iso8601_timestamp"("anomalyenddate") AS date) - CAST("from_iso8601_timestamp"("anomalystartdate") AS date))) duration
        , monitorarn
        , CAST(RootCauses AS ARRAY(JSON)) root_causes_array
        FROM
          "${data_collection_database_name}"."cost_anomaly_data"
        WHERE ("date_parse"("concat"("year", "month", "day"), '%Y%m%d') >= (current_timestamp - INTERVAL  '3' MONTH))
      )
      , latest_data AS (
        SELECT
          anomalyid
        , MAX(anomalylastupdatedate) latest_date
        FROM
          unnested_data
        GROUP BY anomalyid
      )
      SELECT DISTINCT
        d."year"
      , d."month"
      , d.payer_id
      , d.anomalyid
      , d.dimensionvalue
      , d.anomaly_start_date
      , d.anomalylastupdatedate
      , (CASE WHEN (ROW_NUMBER() OVER (PARTITION BY d.anomalyid ORDER BY TRY(json_extract_scalar(rc, '$.region')) ASC) = 1) THEN d.maximpact ELSE null END) maximpact
      , (CASE WHEN (ROW_NUMBER() OVER (PARTITION BY d.anomalyid ORDER BY TRY(json_extract_scalar(rc, '$.region')) ASC) = 1) THEN d.totalactualspend ELSE null END) totalactualspend
      , (CASE WHEN (ROW_NUMBER() OVER (PARTITION BY d.anomalyid ORDER BY TRY(json_extract_scalar(rc, '$.region')) ASC) = 1) THEN d.totalexpectedspend ELSE null END) totalexpectedspend
      , (CASE WHEN (ROW_NUMBER() OVER (PARTITION BY d.anomalyid ORDER BY TRY(json_extract_scalar(rc, '$.region')) ASC) = 1) THEN d.total_impact ELSE null END) total_impact
      , d.totalimpactpercentage
      , d.duration
      , d.monitorarn
      , TRY(json_extract_scalar(rc, '$.region')) region
      , TRY(json_extract_scalar(rc, '$.service')) service
      , TRY(json_extract_scalar(rc, '$.linkedaccountname')) linkedaccountname
      , TRY(json_extract_scalar(rc, '$.linkedaccount')) linkedaccount
      , TRY(json_extract_scalar(rc, '$.usagetype')) usagetype
      , TRY(json_extract_scalar(rc, '$.Contribution')) Contribution
      FROM
        ((unnested_data d
      CROSS JOIN UNNEST(root_causes_array) t (rc))
      INNER JOIN latest_data ld ON ((d.anomalyid = ld.anomalyid) AND (d.anomalylastupdatedate = ld.latest_date)))
    schedules:
    - default
    parameters:
        data_collection_database_name:
          type: athena
          query: SELECT DISTINCT table_schema FROM information_schema.columns WHERE table_name = 'cost_anomaly_data'
          default: optimization_data
          description: "Enter the name of the data collection database"
          global: True
